<% layout("/layouts/boilerplate") %>
<style>
    #filters{
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        /* Hides the scrollbar for a cleaner look on mobile while keeping it functional */
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;  /* Firefox */
    }
    #filters::-webkit-scrollbar {
        display: none; /* Chrome, Safari and Opera */
    }
    .filter{
        text-align:center;
        margin-right: 2rem;
        margin-top: 2rem;
        opacity: 0.7;
        transition: opacity 0.2s ease;
        flex-shrink: 0; /* Prevents icons from squishing on mobile */
    }
    .filter:hover{
        cursor: pointer;
        opacity: 1;
        transform: scale(1.05);
    }
    .filter p{
        font-size: 0.8rem;
    }
    .tax-toogle{
        border: 1px solid black ;
        border-radius:1rem ;
        height: 3.25rem;
        padding: 1rem;
        margin-left: 2rem;
        display: flex;
        align-items: center;
        flex-shrink: 0;
    }
    .tax-info{
        display: none;
    }
    /* For Tablets */
    @media (max-width: 992px) {
        .filter {
            margin-right: 1.5rem;
            margin-top: 1.5rem;
        }
        .tax-toogle {
            margin-left: 1rem;
            margin-top: 1.5rem;
        }
    }

    /* For Mobile Landscape */
    @media (max-width: 768px) {
        .filter {
            margin-right: 1rem;
            margin-top: 1rem;
        }
        .tax-toogle {
            margin-left: 0.5rem;
            margin-top: 1rem;
            padding: 0.75rem;
            font-size: 0.9rem;
        }
    }

    /* For Mobile Portrait */
    @media (max-width: 576px) {
        .filter {
            margin-right: 0.5rem;
        }
        .filter p {
            font-size: 0.75rem;
        }
        .tax-toogle {
            margin-left: 0;
            margin-top: 1rem;
            height: auto; 
            padding: 0.5rem;
            font-size: 0.8rem;
        }
    }
</style>
<body>
   <div id="filters" class="d-flex flex-nowrap overflow-x-auto overflow-y-hidden gap-4 my-1">
    <a href="/listings?category=Trending" class="text-decoration-none text-dark">
    <div class="filter filter-item d-flex flex-column align-items-center text-muted">
        <div><i class="fa-solid fa-fire"></i></div>
        <p>Trending</p>
    </div>
    </a>
    <a href="/listings?category=Rooms" class="text-decoration-none text-dark">
    <div class="filter filter-item d-flex flex-column align-items-center text-muted">
        <div><i class="fa-solid fa-bed"></i></div>
        <p>Rooms</p>
    </div>
    </a>
    <a href="/listings?category=Iconic Cities" class="text-decoration-none text-dark">
     <div class="filter filter-item d-flex flex-column align-items-center text-muted">
        <div><i class="fa-solid fa-mountain-city"></i></div>
        <p>Iconic Cities</p>
    </div>
    </a>
     <a href="/listings?category=Mountains" class="text-decoration-none text-dark">
    <div class="filter filter-item d-flex flex-column align-items-center text-muted">
        <div><i class="fa-solid fa-mountain"></i></div>
        <p>Mountains</p>
    </div>
    </a>
    <a href="/listings?category=Castles" class="text-decoration-none text-dark">
     <div class="filter filter-item d-flex flex-column align-items-center text-muted">
        <div><i class="fa-brands fa-fort-awesome"></i></div>
        <p>Castles</p>
    </div>
    </a>
    <a href="/listings?category=Amazing Pools" class="text-decoration-none text-dark">
    <div class="filter filter-item d-flex flex-column align-items-center text-muted">
        <div><i class="fa-solid fa-person-swimming"></i></div>
        <p>Amazing pools</p>
    </div>
    </a>
    <a href="/listings?category=Camping" class="text-decoration-none text-dark">
     <div class="filter filter-item d-flex flex-column align-items-center text-muted">
        <div><i class="fa-solid fa-campground"></i></div>
        <p>Camping</p>
    </div>
    </a>
    <a href="/listings?category=Farming" class="text-decoration-none text-dark">
    <div class="filter filter-item d-flex flex-column align-items-center text-muted">
        <div><i class="fa-solid fa-cow"></i></div>
        <p>Farming</p>
    </div>
    </a>
    <a href="/listings?category=Arctic" class="text-decoration-none text-dark">
    <div class="filter filter-item d-flex flex-column align-items-center text-muted">
        <div><i class="fa-regular fa-snowflake"></i></div>
        <p>arctic</p>
    </div>
    </a>
    <div class="tax-toogle">
        <div class="form-check-reverse form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="switchCheckDefault">
        <label class="form-check-label" for="switchCheckDefault">Display total after taxes</label>
</div>

    </div>
   </div>
  <div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 mt-3" >
     <% for(let listing of allListings){%>
        <a href="/listings/<%=listing._id%>" class="link">
         <div class="card cols listing-card">
        <img src="<%= listing.image.url %>" class="card-img-top" alt="listing image" style="height: 20rem";>
        <div class="card-img-overlay"></div>
        <div class="card-body">
            <p class="card-text">
               <b> <%= listing.title %> <br></b>
                &#8377; <%= listing.price.toLocaleString("en-IN") %> /night 
                <i class="tax-info">&nbsp;&nbsp;+18%GST</i>
            </p>
        </div>
        </div>
        <%}%>
        </a>
  </div>
  <% if(allListings.length === 0) { %>
    <div class="alert alert-danger col-6 offset-3" role="alert">
        <h4 class="alert-heading">No results found!</h4>
        <p>We couldn't find any listings matching your search.</p>
        <a href="/listings" class="btn btn-outline-danger">View all listings</a>
    </div>
<% } %>
</body>

<script>
    const taxswitch=document.getElementById("switchCheckDefault");
    taxswitch.addEventListener('click',()=>{
       let taxInfo=document.getElementsByClassName("tax-info");
       for( info of taxInfo){
        if(info.style.display!=="inline"){
            info.style.display="inline";
         } else{
            info.style.display="none";
        }
    }

       });
</script>
